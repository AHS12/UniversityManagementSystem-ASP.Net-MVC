@using UniversityManagementSystemWebApp.Models
@model UniversityManagementSystemWebApp.Models.Student

@{
    ViewBag.Title = "Result";
    Layout = Layout;
    List<Student> RegNoList = ViewBag.RegNoList;
}

<head>
    <title>ViewBag.Title </title>

    <style>
        input[readonly].readonly {
            background-color: transparent;
            -webkit-box-shadow: none;
            -ms-box-shadow: none;
            box-shadow: none;
        }
    </style>
</head>

<div class="container">
    <div class="form-group">
        <h2>Show Result</h2>
    </div>
    <hr />
    <form class="form-horizontal">
        <div class="form-group">
            <div class="col-md-2 control-label">
                @Html.LabelFor(x => x.StudentId)
            </div>


            <div class="col-md-10">

                @Html.DropDownListFor(x => x.StudentId, new SelectList(RegNoList, "StudentId", "RegistrationNo"), "--SELECT--")
                @Html.ValidationMessageFor(x => x.StudentId)
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-2 control-label">
                <label>Name</label>
            </div>


            <div class="col-md-10">

                <input class="readonly" type='text' name="Name" id="Name" readonly="readonly" />
            </div>

        </div>
        <div class="form-group">
            <div class="col-md-2 control-label">
                <label>Email</label>
            </div>


            <div class="col-md-10">

                <input class="readonly" type='text' name="Email" id="Email" readonly="readonly" />
            </div>

        </div>

        <div class="form-group">
            <div class="col-md-2 control-label">
                <label>Department</label>

            </div>
            <div class="col-md-10">

                <input class="readonly" type='text' name="Department" id="Department" readonly="readonly" />
            </div>

        </div>


        <div class="container">
            <table class="table table-bordered table-hover">
                <thead id="Tablehead">

                </thead>
                <tbody id="ShowResult"></tbody>
            </table>
        </div>


        <script type="text/javascript">


            $(document).ready(function () {

                $("#StudentId").change(function () {
                    var studentId = $("#StudentId").val();
                    // alert("show dept id " + studentId);
                    var json = { StudentId: studentId };
                    //for all Student info name,email,dept
                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetAllInfoByStudentId", "EnrollCourse")',
                        contentType: "application/json; charset=utf-8",
                        data: JSON.stringify(json),
                        success: function (data) {
                            if (data != null) {
                                $('#Name').val(data.StudentName);
                                $('#Email').val(data.Email);
                                $('#Department').val(data.DeptCode);
                            } else {
                                alert("Something went wrong");
                            }
                        }

                    });




                    $.ajax({
                        type: "POST",
                        url: '@Url.Action("GetStudentResultById", "Student")',
                        contentType: "application/json; charset=utf-8",
                        data: JSON.stringify(json),
                        success: function (data) {
                            $("#Tablehead").empty();
                            $("#ShowResult").empty();
                            $("#Tablehead").empty();
                            $("#Tablehead").append('<tr> <th>Course Code</th> <th>Course Name</th> <th>Grade</th></tr>');
                            $.each(data, function (key, value) {

                                $("#ShowResult").append('<tr> <td>' + value.CourseCode + '</td> <td>' + value.CourseName + '</td> <td>' + value.Grade + '</td></tr>');

                            });
                        }

                    });

                });
            });



        </script>
    </form>
</div>